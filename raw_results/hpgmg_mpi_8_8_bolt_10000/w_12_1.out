

********************************************************************************
***                            HPGMG-FV Benchmark                            ***
********************************************************************************
Requested MPI_THREAD_FUNNELED, got MPI_THREAD_FUNNELED
2 MPI Tasks of 28 threads


===== Benchmark setup ==========================================================

attempting to create a 512^3 level from 8 x 256^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  Allocating vectors... done
  Calculating boxes per process... target=4.000, max=4
  Creating Poisson (a=0.000000, b=1.000000) test problem
  calculating D^{-1} exactly for level h=1.953125e-03 using  64 colors...  done (7.163566 seconds)

attempting to create a 256^3 level from 8 x 128^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  Allocating vectors... done
  Calculating boxes per process... target=4.000, max=4

attempting to create a 128^3 level from 8 x 64^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  Allocating vectors... done
  Calculating boxes per process... target=4.000, max=4

attempting to create a 64^3 level from 8 x 32^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  Allocating vectors... done
  Calculating boxes per process... target=4.000, max=4

attempting to create a 32^3 level from 8 x 16^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  Allocating vectors... done
  Calculating boxes per process... target=4.000, max=4

attempting to create a 16^3 level from 8 x 8^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  Allocating vectors... done
  Calculating boxes per process... target=4.000, max=4

attempting to create a 8^3 level from 1 x 8^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  Allocating vectors... done
  Calculating boxes per process... target=0.500, max=1

attempting to create a 4^3 level from 1 x 4^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  Allocating vectors... done
  Calculating boxes per process... target=0.500, max=1

attempting to create a 2^3 level from 1 x 2^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  Allocating vectors... done
  Calculating boxes per process... target=0.500, max=1

  Building restriction and interpolation lists... done

  Building MPI subcommunicator for level  1... done (0.000472 seconds)
  Building MPI subcommunicator for level  2... done (0.000358 seconds)
  Building MPI subcommunicator for level  3... done (0.000269 seconds)
  Building MPI subcommunicator for level  4... done (0.000276 seconds)
  Building MPI subcommunicator for level  5... done (0.000025 seconds)
  Building MPI subcommunicator for level  6... done (0.000028 seconds)
  Building MPI subcommunicator for level  7... done (0.000022 seconds)
  Building MPI subcommunicator for level  8... done (0.000021 seconds)

  calculating D^{-1} exactly for level h=3.906250e-03 using  64 colors...  done (1.272843 seconds)
  calculating D^{-1} exactly for level h=7.812500e-03 using  64 colors...  done (0.173114 seconds)
  calculating D^{-1} exactly for level h=1.562500e-02 using  64 colors...  done (0.023977 seconds)
  calculating D^{-1} exactly for level h=3.125000e-02 using  64 colors...  done (0.007720 seconds)
  calculating D^{-1} exactly for level h=6.250000e-02 using  64 colors...  done (0.004520 seconds)
  calculating D^{-1} exactly for level h=1.250000e-01 using  64 colors...  done (0.001569 seconds)
  calculating D^{-1} exactly for level h=2.500000e-01 using  64 colors...  done (0.000782 seconds)
  calculating D^{-1} exactly for level h=5.000000e-01 using   8 colors...  done (0.000086 seconds)



===== Warming up by running 1 solves ==========================================
FMGSolve... f-cycle     norm=4.151187824908527e-08  rel=4.153376389499612e-08  done (1.825235 seconds)


===== Running 10 solves ========================================================
FMGSolve... f-cycle     norm=4.151187824908527e-08  rel=4.153376389499612e-08  done (1.826542 seconds)
FMGSolve... f-cycle     norm=4.151187824908527e-08  rel=4.153376389499612e-08  done (1.834706 seconds)
FMGSolve... f-cycle     norm=4.151187824908527e-08  rel=4.153376389499612e-08  done (1.828271 seconds)
FMGSolve... f-cycle     norm=4.151187824908527e-08  rel=4.153376389499612e-08  done (1.826614 seconds)
FMGSolve... f-cycle     norm=4.151187824908527e-08  rel=4.153376389499612e-08  done (1.827102 seconds)
FMGSolve... f-cycle     norm=4.151187824908527e-08  rel=4.153376389499612e-08  done (1.827290 seconds)
FMGSolve... f-cycle     norm=4.151187824908527e-08  rel=4.153376389499612e-08  done (1.826507 seconds)
FMGSolve... f-cycle     norm=4.151187824908527e-08  rel=4.153376389499612e-08  done (1.826947 seconds)
FMGSolve... f-cycle     norm=4.151187824908527e-08  rel=4.153376389499612e-08  done (1.826232 seconds)
FMGSolve... f-cycle     norm=4.151187824908527e-08  rel=4.153376389499612e-08  done (1.828161 seconds)


===== Timing Breakdown =========================================================


level                                0            1            2            3            4            5            6            7            8 
level dimension                  512^3        256^3        128^3         64^3         32^3         16^3          8^3          4^3          2^3 
box dimension                    256^3        128^3         64^3         32^3         16^3          8^3          8^3          4^3          2^3        total
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
smooth                        0.950868     0.297514     0.054535     0.008024     0.002121     0.001184     0.000851     0.000175     0.000000     1.315273
  max                         0.954687     0.298732     0.054906     0.008063     0.002149     0.001184     0.000851     0.000175     0.000000     1.320748
  min                         0.950868     0.297514     0.054535     0.008024     0.002121     0.001176     0.000000     0.000000     0.000000     1.314238
residual                      0.192115     0.029594     0.005775     0.000828     0.000212     0.000100     0.000087     0.000018     0.000011     0.228739
applyOp                       0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000020     0.000020
BLAS1                         0.049948     0.001694     0.000359     0.000087     0.000053     0.000048     0.000011     0.000005     0.000042     0.052246
BLAS3                         0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
Boundary Conditions           0.018962     0.008763     0.002974     0.001527     0.001096     0.000863     0.001192     0.001052     0.000374     0.036803
Restriction                   0.018017     0.003343     0.000390     0.000119     0.000070     0.000198     0.000011     0.000005     0.000000     0.022153
  local restriction           0.018015     0.003340     0.000388     0.000116     0.000067     0.000058     0.000009     0.000003     0.000000     0.021996
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000000     0.000061     0.000000     0.000000     0.000000     0.000061
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000006     0.000000     0.000000     0.000000     0.000006
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000000     0.000000     0.000069     0.000000     0.000000     0.000000     0.000069
Interpolation                 0.052270     0.009114     0.001220     0.000299     0.000130     0.000191     0.000027     0.000020     0.000000     0.063269
  local interpolation         0.052268     0.009113     0.001218     0.000297     0.000128     0.000078     0.000026     0.000016     0.000000     0.063144
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000000     0.000074     0.000000     0.000000     0.000000     0.000074
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000035     0.000000     0.000000     0.000000     0.000035
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000000     0.000000     0.000001     0.000000     0.000000     0.000000     0.000001
Ghost Zone Exchange           0.063705     0.033675     0.012090     0.004574     0.003139     0.002695     0.000008     0.000006     0.000004     0.119895
  local exchange              0.030900     0.014929     0.003949     0.001538     0.001168     0.000866     0.000000     0.000000     0.000000     0.053350
  pack MPI buffers            0.002000     0.001200     0.000610     0.000541     0.000598     0.000704     0.000000     0.000000     0.000000     0.005653
  unpack MPI buffers          0.002023     0.001352     0.000962     0.000594     0.000697     0.000747     0.000000     0.000000     0.000000     0.006375
  MPI_Isend                   0.014542     0.007268     0.002806     0.000582     0.000176     0.000069     0.000000     0.000000     0.000000     0.025443
  MPI_Irecv                   0.000032     0.000047     0.000035     0.000023     0.000009     0.000011     0.000000     0.000000     0.000000     0.000157
  MPI_Waitall                 0.014191     0.008855     0.003709     0.001278     0.000465     0.000263     0.000000     0.000000     0.000000     0.028761
MPI_collectives               0.002405     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000045     0.002450
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
Total by level                1.339764     0.380420     0.076453     0.015315     0.006791     0.005082     0.002209     0.001315     0.000442     1.827789

   Total time in MGBuild      1.557848 seconds
   Total time in MGSolve      1.827829 seconds
      number of v-cycles             1
Bottom solver iterations            16




===== Performance Summary ======================================================
  h=1.953125000000000e-03  DOF=1.342177280000000e+08  time=1.827829  DOF/s=7.343e+07  MPI=2  OMP=28


===== Richardson error analysis ================================================
FMGSolve... f-cycle     norm=4.151187824908527e-08  rel=4.153376389499612e-08  done (1.823877 seconds)
FMGSolve... f-cycle     norm=5.144231718379189e-07  rel=5.155086782761839e-07  done (0.291685 seconds)
FMGSolve... f-cycle     norm=7.454875268653183e-06  rel=7.517955872287669e-06  done (0.048349 seconds)
  h=1.953125000000000e-03  ||error||=9.221160354386249e-10
  order=4.011


===== Deallocating memory ======================================================
attempting to free the restriction and interpolation lists... done
attempting to free the     2^3 level... done
attempting to free the     4^3 level... done
attempting to free the     8^3 level... done
attempting to free the    16^3 level... done
attempting to free the    32^3 level... done
attempting to free the    64^3 level... done
attempting to free the   128^3 level... done
attempting to free the   256^3 level... done
attempting to free the   512^3 level... done


===== Done =====================================================================
