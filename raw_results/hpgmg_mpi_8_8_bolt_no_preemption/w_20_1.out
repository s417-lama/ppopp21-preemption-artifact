

********************************************************************************
***                            HPGMG-FV Benchmark                            ***
********************************************************************************
Requested MPI_THREAD_FUNNELED, got MPI_THREAD_FUNNELED
2 MPI Tasks of 28 threads


===== Benchmark setup ==========================================================

attempting to create a 512^3 level from 8 x 256^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  Allocating vectors... done
  Calculating boxes per process... target=4.000, max=4
  Creating Poisson (a=0.000000, b=1.000000) test problem
  calculating D^{-1} exactly for level h=1.953125e-03 using  64 colors...  done (5.900834 seconds)

attempting to create a 256^3 level from 8 x 128^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  Allocating vectors... done
  Calculating boxes per process... target=4.000, max=4

attempting to create a 128^3 level from 8 x 64^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  Allocating vectors... done
  Calculating boxes per process... target=4.000, max=4

attempting to create a 64^3 level from 8 x 32^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  Allocating vectors... done
  Calculating boxes per process... target=4.000, max=4

attempting to create a 32^3 level from 8 x 16^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  Allocating vectors... done
  Calculating boxes per process... target=4.000, max=4

attempting to create a 16^3 level from 8 x 8^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  Allocating vectors... done
  Calculating boxes per process... target=4.000, max=4

attempting to create a 8^3 level from 1 x 8^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  Allocating vectors... done
  Calculating boxes per process... target=0.500, max=1

attempting to create a 4^3 level from 1 x 4^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  Allocating vectors... done
  Calculating boxes per process... target=0.500, max=1

attempting to create a 2^3 level from 1 x 2^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  Allocating vectors... done
  Calculating boxes per process... target=0.500, max=1

  Building restriction and interpolation lists... done

  Building MPI subcommunicator for level  1... done (0.000459 seconds)
  Building MPI subcommunicator for level  2... done (0.000085 seconds)
  Building MPI subcommunicator for level  3... done (0.000420 seconds)
  Building MPI subcommunicator for level  4... done (0.000068 seconds)
  Building MPI subcommunicator for level  5... done (0.000025 seconds)
  Building MPI subcommunicator for level  6... done (0.000027 seconds)
  Building MPI subcommunicator for level  7... done (0.000022 seconds)
  Building MPI subcommunicator for level  8... done (0.000021 seconds)

  calculating D^{-1} exactly for level h=3.906250e-03 using  64 colors...  done (0.868177 seconds)
  calculating D^{-1} exactly for level h=7.812500e-03 using  64 colors...  done (0.120370 seconds)
  calculating D^{-1} exactly for level h=1.562500e-02 using  64 colors...  done (0.019199 seconds)
  calculating D^{-1} exactly for level h=3.125000e-02 using  64 colors...  done (0.007691 seconds)
  calculating D^{-1} exactly for level h=6.250000e-02 using  64 colors...  done (0.006469 seconds)
  calculating D^{-1} exactly for level h=1.250000e-01 using  64 colors...  done (0.001832 seconds)
  calculating D^{-1} exactly for level h=2.500000e-01 using  64 colors...  done (0.001036 seconds)
  calculating D^{-1} exactly for level h=5.000000e-01 using   8 colors...  done (0.000144 seconds)



===== Warming up by running 1 solves ==========================================
FMGSolve... f-cycle     norm=4.151187824908527e-08  rel=4.153376389499612e-08  done (1.487098 seconds)


===== Running 10 solves ========================================================
FMGSolve... f-cycle     norm=4.151187824908527e-08  rel=4.153376389499612e-08  done (1.484729 seconds)
FMGSolve... f-cycle     norm=4.151187824908527e-08  rel=4.153376389499612e-08  done (1.485978 seconds)
FMGSolve... f-cycle     norm=4.151187824908527e-08  rel=4.153376389499612e-08  done (1.485907 seconds)
FMGSolve... f-cycle     norm=4.151187824908527e-08  rel=4.153376389499612e-08  done (1.484961 seconds)
FMGSolve... f-cycle     norm=4.151187824908527e-08  rel=4.153376389499612e-08  done (1.487742 seconds)
FMGSolve... f-cycle     norm=4.151187824908527e-08  rel=4.153376389499612e-08  done (1.484404 seconds)
FMGSolve... f-cycle     norm=4.151187824908527e-08  rel=4.153376389499612e-08  done (1.484707 seconds)
FMGSolve... f-cycle     norm=4.151187824908527e-08  rel=4.153376389499612e-08  done (1.484399 seconds)
FMGSolve... f-cycle     norm=4.151187824908527e-08  rel=4.153376389499612e-08  done (1.485475 seconds)
FMGSolve... f-cycle     norm=4.151187824908527e-08  rel=4.153376389499612e-08  done (1.486603 seconds)


===== Timing Breakdown =========================================================


level                                0            1            2            3            4            5            6            7            8 
level dimension                  512^3        256^3        128^3         64^3         32^3         16^3          8^3          4^3          2^3 
box dimension                    256^3        128^3         64^3         32^3         16^3          8^3          8^3          4^3          2^3        total
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
smooth                        0.813826     0.208877     0.035680     0.005239     0.001541     0.001212     0.000895     0.000196     0.000000     1.067466
  max                         0.817990     0.208877     0.036892     0.005426     0.001541     0.001224     0.000895     0.000196     0.000000     1.073041
  min                         0.813826     0.208732     0.035680     0.005239     0.001357     0.001212     0.000000     0.000000     0.000000     1.066045
residual                      0.146876     0.019447     0.003554     0.000533     0.000149     0.000103     0.000080     0.000020     0.000009     0.170772
applyOp                       0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000022     0.000022
BLAS1                         0.042854     0.001452     0.000285     0.000069     0.000059     0.000072     0.000012     0.000005     0.000041     0.044848
BLAS3                         0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
Boundary Conditions           0.014460     0.006686     0.002382     0.001258     0.001064     0.001271     0.001449     0.001570     0.000655     0.030795
Restriction                   0.014989     0.002819     0.000323     0.000098     0.000091     0.000414     0.000012     0.000005     0.000000     0.018750
  local restriction           0.014987     0.002817     0.000321     0.000097     0.000089     0.000106     0.000010     0.000003     0.000000     0.018430
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000000     0.000105     0.000000     0.000000     0.000000     0.000105
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000006     0.000000     0.000000     0.000000     0.000006
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000000     0.000000     0.000194     0.000000     0.000000     0.000000     0.000194
Interpolation                 0.038749     0.006389     0.000796     0.000183     0.000133     0.000247     0.000029     0.000021     0.000000     0.046547
  local interpolation         0.038747     0.006387     0.000794     0.000181     0.000131     0.000102     0.000028     0.000017     0.000000     0.046387
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000000     0.000106     0.000000     0.000000     0.000000     0.000106
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000037     0.000000     0.000000     0.000000     0.000037
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000000     0.000000     0.000001     0.000000     0.000000     0.000000     0.000001
Ghost Zone Exchange           0.053060     0.033161     0.011372     0.005687     0.004186     0.004248     0.000008     0.000007     0.000005     0.111736
  local exchange              0.021298     0.010569     0.002295     0.001538     0.001249     0.001229     0.000000     0.000000     0.000000     0.038179
  pack MPI buffers            0.001538     0.000921     0.000546     0.000871     0.001035     0.001280     0.000000     0.000000     0.000000     0.006192
  unpack MPI buffers          0.001597     0.001203     0.000998     0.000970     0.001141     0.001298     0.000000     0.000000     0.000000     0.007207
  MPI_Isend                   0.014582     0.007721     0.003382     0.000685     0.000189     0.000078     0.000000     0.000000     0.000000     0.026636
  MPI_Irecv                   0.000033     0.000048     0.000040     0.000016     0.000012     0.000016     0.000000     0.000000     0.000000     0.000165
  MPI_Waitall                 0.013998     0.012671     0.004088     0.001588     0.000537     0.000319     0.000000     0.000000     0.000000     0.033201
MPI_collectives               0.006306     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000043     0.006349
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
Total by level                1.122923     0.276294     0.053707     0.012966     0.007271     0.007249     0.002512     0.001863     0.000665     1.485449

   Total time in MGBuild      1.091425 seconds
   Total time in MGSolve      1.485482 seconds
      number of v-cycles             1
Bottom solver iterations            16




===== Performance Summary ======================================================
  h=1.953125000000000e-03  DOF=1.342177280000000e+08  time=1.485482  DOF/s=9.035e+07  MPI=2  OMP=28


===== Richardson error analysis ================================================
FMGSolve... f-cycle     norm=4.151187824908527e-08  rel=4.153376389499612e-08  done (1.485568 seconds)
FMGSolve... f-cycle     norm=5.144231718379189e-07  rel=5.155086782761839e-07  done (0.216636 seconds)
FMGSolve... f-cycle     norm=7.454875268653183e-06  rel=7.517955872287669e-06  done (0.041516 seconds)
  h=1.953125000000000e-03  ||error||=9.221160354386249e-10
  order=4.011


===== Deallocating memory ======================================================
attempting to free the restriction and interpolation lists... done
attempting to free the     2^3 level... done
attempting to free the     4^3 level... done
attempting to free the     8^3 level... done
attempting to free the    16^3 level... done
attempting to free the    32^3 level... done
attempting to free the    64^3 level... done
attempting to free the   128^3 level... done
attempting to free the   256^3 level... done
attempting to free the   512^3 level... done


===== Done =====================================================================
