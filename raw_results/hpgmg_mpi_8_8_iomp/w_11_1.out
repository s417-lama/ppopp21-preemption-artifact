

********************************************************************************
***                            HPGMG-FV Benchmark                            ***
********************************************************************************
Requested MPI_THREAD_FUNNELED, got MPI_THREAD_FUNNELED
2 MPI Tasks of 28 threads


===== Benchmark setup ==========================================================

attempting to create a 512^3 level from 8 x 256^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  Allocating vectors... done
  Calculating boxes per process... target=4.000, max=4
  Creating Poisson (a=0.000000, b=1.000000) test problem
  calculating D^{-1} exactly for level h=1.953125e-03 using  64 colors...  done (7.390467 seconds)

attempting to create a 256^3 level from 8 x 128^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  Allocating vectors... done
  Calculating boxes per process... target=4.000, max=4

attempting to create a 128^3 level from 8 x 64^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  Allocating vectors... done
  Calculating boxes per process... target=4.000, max=4

attempting to create a 64^3 level from 8 x 32^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  Allocating vectors... done
  Calculating boxes per process... target=4.000, max=4

attempting to create a 32^3 level from 8 x 16^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  Allocating vectors... done
  Calculating boxes per process... target=4.000, max=4

attempting to create a 16^3 level from 8 x 8^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  Allocating vectors... done
  Calculating boxes per process... target=4.000, max=4

attempting to create a 8^3 level from 1 x 8^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  Allocating vectors... done
  Calculating boxes per process... target=0.500, max=1

attempting to create a 4^3 level from 1 x 4^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  Allocating vectors... done
  Calculating boxes per process... target=0.500, max=1

attempting to create a 2^3 level from 1 x 2^3 boxes distributed among 2 tasks...
  boundary condition = BC_DIRICHLET
  Decomposing level via Z-mort ordering... done
  Allocating vectors... done
  Calculating boxes per process... target=0.500, max=1

  Building restriction and interpolation lists... done

  Building MPI subcommunicator for level  1... done (0.000603 seconds)
  Building MPI subcommunicator for level  2... done (0.000319 seconds)
  Building MPI subcommunicator for level  3... done (0.000230 seconds)
  Building MPI subcommunicator for level  4... done (0.000245 seconds)
  Building MPI subcommunicator for level  5... done (0.000017 seconds)
  Building MPI subcommunicator for level  6... done (0.000024 seconds)
  Building MPI subcommunicator for level  7... done (0.000017 seconds)
  Building MPI subcommunicator for level  8... done (0.000015 seconds)

  calculating D^{-1} exactly for level h=3.906250e-03 using  64 colors...  done (1.318739 seconds)
  calculating D^{-1} exactly for level h=7.812500e-03 using  64 colors...  done (0.222611 seconds)
  calculating D^{-1} exactly for level h=1.562500e-02 using  64 colors...  done (0.047129 seconds)
  calculating D^{-1} exactly for level h=3.125000e-02 using  64 colors...  done (0.021211 seconds)
  calculating D^{-1} exactly for level h=6.250000e-02 using  64 colors...  done (0.017230 seconds)
  calculating D^{-1} exactly for level h=1.250000e-01 using  64 colors...  done (0.003613 seconds)
  calculating D^{-1} exactly for level h=2.500000e-01 using  64 colors...  done (0.002853 seconds)
  calculating D^{-1} exactly for level h=5.000000e-01 using   8 colors...  done (0.000367 seconds)



===== Warming up by running 1 solves ==========================================
FMGSolve... f-cycle     norm=4.151187824908527e-08  rel=4.153376389499612e-08  done (2.106983 seconds)


===== Running 10 solves ========================================================
FMGSolve... f-cycle     norm=4.151187824908527e-08  rel=4.153376389499612e-08  done (2.097361 seconds)
FMGSolve... f-cycle     norm=4.151187824908527e-08  rel=4.153376389499612e-08  done (2.096745 seconds)
FMGSolve... f-cycle     norm=4.151187824908527e-08  rel=4.153376389499612e-08  done (2.095483 seconds)
FMGSolve... f-cycle     norm=4.151187824908527e-08  rel=4.153376389499612e-08  done (2.089256 seconds)
FMGSolve... f-cycle     norm=4.151187824908527e-08  rel=4.153376389499612e-08  done (2.116664 seconds)
FMGSolve... f-cycle     norm=4.151187824908527e-08  rel=4.153376389499612e-08  done (2.098085 seconds)
FMGSolve... f-cycle     norm=4.151187824908527e-08  rel=4.153376389499612e-08  done (2.091726 seconds)
FMGSolve... f-cycle     norm=4.151187824908527e-08  rel=4.153376389499612e-08  done (2.090755 seconds)
FMGSolve... f-cycle     norm=4.151187824908527e-08  rel=4.153376389499612e-08  done (2.094286 seconds)
FMGSolve... f-cycle     norm=4.151187824908527e-08  rel=4.153376389499612e-08  done (2.125640 seconds)


===== Timing Breakdown =========================================================


level                                0            1            2            3            4            5            6            7            8 
level dimension                  512^3        256^3        128^3         64^3         32^3         16^3          8^3          4^3          2^3 
box dimension                    256^3        128^3         64^3         32^3         16^3          8^3          8^3          4^3          2^3        total
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
smooth                        1.087108     0.310070     0.067837     0.013243     0.004577     0.003433     0.000839     0.000187     0.000000     1.487293
  max                         1.087108     0.310070     0.067837     0.013270     0.004612     0.003474     0.000839     0.000187     0.000000     1.487397
  min                         1.073401     0.304539     0.067396     0.013243     0.004577     0.003433     0.000000     0.000000     0.000000     1.466588
residual                      0.205252     0.030287     0.006835     0.001418     0.000424     0.000293     0.000077     0.000019     0.000011     0.244616
applyOp                       0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000024     0.000024
BLAS1                         0.052252     0.001845     0.000491     0.000249     0.000188     0.000211     0.000013     0.000006     0.000053     0.055308
BLAS3                         0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
Boundary Conditions           0.019640     0.011704     0.005195     0.003525     0.003347     0.003734     0.004247     0.004787     0.001798     0.057976
Restriction                   0.018133     0.003565     0.000648     0.000285     0.000269     0.000763     0.000013     0.000009     0.000000     0.023683
  local restriction           0.018130     0.003562     0.000645     0.000282     0.000266     0.000298     0.000009     0.000004     0.000000     0.023196
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000000     0.000300     0.000000     0.000000     0.000000     0.000300
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000007     0.000000     0.000000     0.000000     0.000007
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000000     0.000000     0.000156     0.000000     0.000000     0.000000     0.000156
Interpolation                 0.055589     0.011748     0.001860     0.000561     0.000321     0.000653     0.000031     0.000022     0.000000     0.070784
  local interpolation         0.055587     0.011746     0.001858     0.000560     0.000319     0.000312     0.000029     0.000018     0.000000     0.070429
  pack MPI buffers            0.000000     0.000000     0.000000     0.000000     0.000000     0.000300     0.000000     0.000000     0.000000     0.000300
  unpack MPI buffers          0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Isend                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000035     0.000000     0.000000     0.000000     0.000035
  MPI_Irecv                   0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000
  MPI_Waitall                 0.000000     0.000000     0.000000     0.000000     0.000000     0.000002     0.000000     0.000000     0.000000     0.000002
Ghost Zone Exchange           0.069512     0.047095     0.021367     0.011992     0.010200     0.011504     0.000012     0.000012     0.000006     0.171702
  local exchange              0.033402     0.017952     0.007009     0.003944     0.003269     0.003626     0.000000     0.000000     0.000000     0.069202
  pack MPI buffers            0.003368     0.003406     0.002354     0.002497     0.002993     0.003599     0.000000     0.000000     0.000000     0.018218
  unpack MPI buffers          0.003256     0.003147     0.002356     0.002505     0.003000     0.003587     0.000000     0.000000     0.000000     0.017852
  MPI_Isend                   0.014910     0.007319     0.002711     0.000595     0.000226     0.000118     0.000000     0.000000     0.000000     0.025880
  MPI_Irecv                   0.000047     0.000078     0.000051     0.000028     0.000030     0.000036     0.000000     0.000000     0.000000     0.000270
  MPI_Waitall                 0.014508     0.015162     0.006860     0.002393     0.000653     0.000500     0.000000     0.000000     0.000000     0.040076
MPI_collectives               0.001689     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000000     0.000098     0.001787
------------------        ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ ------------ 
Total by level                1.501262     0.412663     0.103314     0.031134     0.019492     0.019642     0.005298     0.005116     0.001637     2.099557

   Total time in MGBuild      1.713103 seconds
   Total time in MGSolve      2.099592 seconds
      number of v-cycles             1
Bottom solver iterations            16




===== Performance Summary ======================================================
  h=1.953125000000000e-03  DOF=1.342177280000000e+08  time=2.099592  DOF/s=6.393e+07  MPI=2  OMP=28


===== Richardson error analysis ================================================
FMGSolve... f-cycle     norm=4.151187824908527e-08  rel=4.153376389499612e-08  done (2.102599 seconds)
FMGSolve... f-cycle     norm=5.144231718379189e-07  rel=5.155086782761839e-07  done (0.367967 seconds)
FMGSolve... f-cycle     norm=7.454875268653183e-06  rel=7.517955872287669e-06  done (0.089672 seconds)
  h=1.953125000000000e-03  ||error||=9.221160354386249e-10
  order=4.011


===== Deallocating memory ======================================================
attempting to free the restriction and interpolation lists... done
attempting to free the     2^3 level... done
attempting to free the     4^3 level... done
attempting to free the     8^3 level... done
attempting to free the    16^3 level... done
attempting to free the    32^3 level... done
attempting to free the    64^3 level... done
attempting to free the   128^3 level... done
attempting to free the   256^3 level... done
attempting to free the   512^3 level... done


===== Done =====================================================================
